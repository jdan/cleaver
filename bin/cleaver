#!/usr/bin/env node

var path = require('path');
var fs = require('fs');
var Cleaver = require(path.resolve(__dirname,'../lib/cleaver'));
var program = require('commander');

program
  .version(require('../package.json').version)
  .usage('[command] [file]');

program
  .command('watch')
  .description('Watch for changes on markdown file')
  .action(function(){
    var file = program.args[0];
    new Cleaver(file).run();

    console.log('Watching for changes on ' + file + '. Ctrl-C to abort.');
    fs.watchFile(file, { persistent: true, interval: 100 }, function () {
      console.log('Rebuilding: ' + new Date());
      new Cleaver(file).run();
    });
  });

program
  .command('init')
  .description('Boilerplate your presentation')
  .action(function(){
    require('../lib/wizard').init(program);
  });
program
  .command('*')
  .action(function(env){
    var file = program.args[0];
    var cleaver = new Cleaver(file);
    cleaver.run();
  });
program.parse(process.argv);

if (!program.args.length) {
  program.help();
}

